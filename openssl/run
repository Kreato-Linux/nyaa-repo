#!/bin/sh
NAME="openssl"
RELEASE="1"
VERSION="3.3.2"
BUILD_DEPENDS="gmake"
SOURCES="https://www.openssl.org/source/openssl-$VERSION.tar.gz"
SHA256SUM="2e8a40b01979afe8be0bbfb3de5dc1c6709fedb46d6c89c10da114ab5fc3d281"
DEPENDS="zlib"
DESCRIPTION="TLS library"

build() {
    if [ "$KPKG_ARCH" != "$(uname -m)" ]; then
	extraArgs="linux-$KPKG_ARCH"
	export CFLAGS=-I/usr/$KPKG_TARGET/usr/include 
	export LDFLAGS=-L/usr/$KPKG_TARGET/lib
	export PKG_CONFIG_PATH=/usr/$KPKG_TARGET/usr/lib/pkgconfig
    fi
    ./config $extraArgs --prefix=/usr --openssldir=/etc/ssl --libdir=lib shared zlib-dynamic
    make -j$(nproc)
}

package() {
    make DESTDIR="$ROOT" install
}

